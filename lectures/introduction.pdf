\documentclass[aspectratio=169]{beamer}
\usefonttheme[onlymath]{serif}
\usepackage[normalem]{ulem}
\usepackage{cancel}
% \usepackage{soul}
% \usepackage{markdown}
\usepackage{comment}
\usepackage{listings}
\usepackage{minted}
\usepackage{xcolor}
\usepackage{gensymb}
\usepackage{forest}
\usepackage{mathtools}

\usetheme{CambridgeUS}
\usecolortheme{dolphin}
\setbeamertemplate{items}[default]
\setbeamertemplate{section in toc}[default]
\setbeamertemplate{note page}[plain]

\usepackage{tikz}
\usetikzlibrary{shapes,arrows,positioning}

\makeatletter
\newcommand{\getfont}{\f@family~\f@size pt}
\makeatother

\definecolor{bgcc}{rgb}{0.95,0.95,0.95}
\setminted[cpp]{
    fontsize=\scriptsize, 
    % linenos,
    numbersep=8pt,
    % gobble=12,
    % frame=lines,
    bgcolor=bgcc,
    % framesep=3mm
} 
\setminted[python]{
    fontsize=\scriptsize, 
    % linenos,
    numbersep=8pt,
    % gobble=12,
    % frame=lines,
    bgcolor=bgcc,
    % framesep=3mm
} 
\setmintedinline[python]{
    bgcolor=bg
}
\forestset{
  dir tree/.style={
    for tree={
      parent anchor=south west,
      child anchor=west,
      anchor=mid west,
      inner ysep=1pt,
      outer ysep=0pt,
      s sep=1pt,
      grow'=0,
      align=left,
      edge path={
        \noexpand\path [draw, \forestoption{edge}] (!u.parent anchor) ++(1em,0) |- (.child anchor)\forestoption{edge label};
      },
      font=\scriptsize\sffamily,
      if n children=0{}{
        delay={
          prepend={[,phantom, calign with current]}
        }
      },
      fit=band,
      before computing xy={
        l=2em
      }
    },
  }
}
\newcommand{\half}{\frac{1}{2}}
\renewcommand{\vec}{\mathbf}
\newcommand{\p}[1]{( #1 )}
\newcommand{\dd}{\mathrm{d}}

% \title[Introduction]{Introduction to PTetra workshop}
\title{Introduction to the PTetra workshop}
\author{Sigvald Marholm}
\institute[UiO]{University of Oslo\\Department of Physics}
\date{25.01.22}

\AtBeginSection[]
{
    \begin{frame}
        \frametitle{Outline}
        \tableofcontents[currentsection]
    \end{frame}
}

\begin{document}

    \begin{frame}
    \titlepage
    \end{frame}

    \begin{frame}
        \frametitle{Outline}
        \tableofcontents
    \end{frame}

    % \section{Learning a new skill}
    % \begin{frame}
    %     \frametitle{Learning a new skill}
    %     \the\textwidth

    %     \getfont
    % \end{frame}

    \section{Orbital motion-limited (OML) theory}
    \begin{frame}[t]
        \frametitle{Orbital motion-limited (OML) theory}
        \begin{columns}[t]
            \begin{column}{0.49\textwidth}
                Energy and momentum conserving orbits.

                ~\\

                Current due to attracted species $s$:
                \begin{align*}
                    I_s &= C\underbracket{\overbracket{A}^{\text{area}} q_s n_s\sqrt{\frac{kT_s}{2\pi m_s}}}_{I_{\mathrm{th,s}}}\Big(1\underbracket{-\frac{q_sV}{kT_s}}_{\eta_s}\Big)^\beta
                \end{align*}
                Current due to repelled species $s$:
                \begin{align*}
                    % I_s = I_{\mathrm{th},s}e^{\eta_s}
                    I_s = I_{\mathrm{th},s}\exp\left(\frac{q_sV}{kT_s}\right)
                \end{align*}
                % ~\\
                {\tiny Mott-smith and Langmuir, DOI: 10.1103/PhysRev.28.727}
            \end{column}
            \begin{column}{0.49\textwidth}
                {
                \centering
                \begin{tabular}{llll}
                    \hline
                            & Plane & Cylinder       & Sphere \\
                    \hline
                    $C$     & 1     & $2/\sqrt{\pi}$ & 1   \\
                    $\beta$ & 0     & 0.5            & 1 \\
                    \hline
                \end{tabular}
            }
                \only<1>{
                    \begin{figure}
                        \centering
                        \includegraphics[width=0.7\textwidth]{orbits.png}
                        \caption{Orbital motions \tiny{(From Bil√©n, PhD thesis, 1998)}}
                    \end{figure}
                }
                \only<2->{
                    ~\\[2em]
                    % \vspace*{2em}
                    Assumptions to OML theory:
                    \begin{itemize}
                        \item Radius $r\ll\lambda_{De}$
                        \item Length $l\gg\lambda_{De}$ (for cylinders)
                        \item $\eta_s > 2$ (for cylinders)
                        \item No drift velocity
                        \item No magnetic field
                    \end{itemize}

                    % ~\\

                }
            \end{column}
        \end{columns}
    \end{frame}

    \begin{frame}
        \frametitle{Orbital motion-limited (OML) theory}
        \begin{columns}
            \begin{column}{0.49\textwidth}
                Langmuir probes:\\
                \hspace*{2em}Vary $V$, measure $I$, infer e.g. $n_e$. \\
                \hspace*{2em}{\tiny E.g. Jacobsen \emph{et al.}, DOI: 10.1088/0957-0233/21/8/085902}

                ~\\

                \onslide<2->{
                    Unconnected objects (spacecraft, dust, etc.) in plasma settle at the \emph{floating potential}:
                    \begin{align*}
                        V=\text{const} \Rightarrow I_e+I_i=C\frac{\dd V}{\dd t}=0
                        % \Rightarrow I_e(V)+I_i(V)=0
                    \end{align*}
                }

                \onslide<3->{ Spaceborn probes are biased wrt. the
                spacecraft, and the probe current also charge the spacecraft!
                }
        
            \end{column}
            \begin{column}{0.32\textwidth}
                \begin{figure}
                    \centering
                    \includegraphics[width=\textwidth]{../Introduction/OML_regions.png}
                    \caption{OML IV-charactersitic for cylinder. \tiny{(From Marholm, PhD thesis)}}
                \end{figure}
            \end{column}
        \end{columns}
    \end{frame}

    \section{Case study}

    \begin{frame}
        \frametitle{Case study}
        \begin{columns}
            \begin{column}{0.49\textwidth}
                \begin{itemize}
                    \item Each team given an object
                    \item Simulate the object
                        \begin{itemize}
                            \item at 1V
                            \item at 2V
                            \item at 3V
                            \item split at 1V and 3V
                            \item at the floating potential
                        \end{itemize}
                        at \emph{ionospheric conditions}
                    % \item Visualize the fields
                    % \item Compare collected currents with past results
                    % \item Compare with past results
                \end{itemize}
            \end{column}
            \begin{column}{0.49\textwidth}
                \begin{figure}
                    \centering
                    \includegraphics[width=0.49\textwidth]{sphere.png}
                    \includegraphics[width=0.49\textwidth]{cylinder.png}
                    \caption{A spherical and cylindrical object where the two halves are biased at different voltages, along with the surrounding electric potential.}
                \end{figure}
            \end{column}
        \end{columns}
    \end{frame}

    \begin{frame}
        \frametitle{Ionospheric conditions}
        \begin{figure}
            \centering
            \includegraphics{ionosphere.png}
            \caption{IRI-2016 model of the ionosphere, $45\degree N$ local noon.
            \tiny{(From Marholm, PhD thesis)}
            }
        \end{figure}
    \end{frame}

    \begin{frame}<1-2>[label=case]
        \frametitle{Ionospheric conditions}
        \begin{columns}
            \begin{column}{0.59\textwidth}
                Parameters for low Earth orbit simulations:
                \begin{itemize}
                    \item $n_e=n_i=10^{11}\,\mathrm{m^{-3}}$
                    \item $T_e=T_i=1000\,\mathrm{K}=0.0862\,\mathrm{eV}$
                    \only<1>{\item $m_i=16\,\mathrm{amu}\quad(O^+)$}
                    \only<2->{\item $m_i=\cancel{16\,\mathrm{amu}}\rightarrow 1/16\,\mathrm{amu}\gg m_e$ (speed up sim.)}
                    \only<1-2>{\item $u=7000\,\mathrm{m/s}$ (drift speed)}
                    % \only<2>{\item $u=\cancel{7000\,\mathrm{m/s}}$ (drift speed) ???}
                    \only<3>{\item $u=\cancel{7000\,\mathrm{m/s}}\rightarrow 112000\,\mathrm{m/s}$}
                    \onslide<3>{\\(maintain correct wake dynamics)}
                \end{itemize}
            \end{column}
            \begin{column}{0.39\textwidth}
                \begin{figure}
                    \centering
                    \includegraphics[width=\textwidth]{swarm.jpg}
                    \caption{The Swarm satellites {\tiny ESA/AOES Medialab}}
                \end{figure}
            \end{column}
        \end{columns}
    \end{frame}

    \begin{frame}
        \frametitle{Reduced mass ratio}
        \begin{columns}
            \begin{column}{0.49\textwidth}
                Reduced $m_i/m_e$...
                \begin{itemize}
                    \item Speeds up simulations ($\tau\propto\sqrt{m_i}$)
                    \item Changes the physics, e.g.:
                        \begin{itemize}
                            \item increases ion current (see OML)
                            \item the mach cone half-angle
                                \begin{align*}
                                    \theta = \arcsin\left(\frac{1}{M}\right), \quad M=\frac{u}{c_s},
                                \end{align*}
                                where $c_s$ is sound speed
                                \begin{align*}
                                    c_s = \sqrt{\frac{kT_e+3kT_i}{m_i}}. %= 2\sqrt\frac{kT}{m_i} % \sim 2000\,\mathrm{m/s}
                                \end{align*}
                                % Must maintain the mach number.
                                % Still possible to maintain the mach cone by increasing $u$!
                        \end{itemize}
                \end{itemize}
            \end{column}
            \begin{column}{0.49\textwidth}
                \begin{figure}
                    \centering
                    \includegraphics[width=\textwidth]{mach.png}
                    \caption{Mach cone superimposed on numerical simulation of rocket wake. \tiny{(From Darian \emph{et al.}, DOI: 10.1002/2017JA024284)}}
                \end{figure}
            \end{column}
        \end{columns}
    \end{frame}

    \againframe<2->{case}


    \section{From beginning to end}
    \begin{frame}
        \frametitle{From beginning to end}
        \begin{figure}
            \centering
            \includegraphics{workflow.pdf}
            % \caption{Simulations from beg}
        \end{figure}
    \end{frame}

    \begin{frame}
        \frametitle{Naming conventions}
        \begin{columns}
            \begin{column}{0.54\textwidth}
                \begin{forest}
                    dir tree
                    [PTetraWorkshop
                      [Geometry
                        [sphere\_0.5R.geo]
                        [sphere\_0.5R.msh]
                        [sphere\_0.5R.topo]
                        [sphere\_0.5R.alujlu.prcnd]
                        [msh2topo $\rightarrow$ ../msh2topo/msh2topo]
                        [msh2topo.dat]
                      ]
                      [Sphere\_0.5R\_3V\_3V
                        [alujlu.prcnd $\rightarrow$ ../Geometry/sphere\_0.5R.alujlu.prcnd]
                        [mptetra $\rightarrow$ ../MPI\_V50i/mptetra]
                        [meshpic.dat $\rightarrow$ ../Geometry/sphere\_0.5R.topo]
                        [pictetra.dat]
                        [pictetra.hst]
                        [*.vtk]
                      ]
                    ]
                \end{forest}
            \end{column}
            \begin{column}{0.44\textwidth}
                \begin{figure}
                    \centering
                    \includegraphics{naming.pdf}
                    % \caption{OML IV-charactersitic for cylinder. \tiny{(From Marholm, PhD thesis)}}
                \end{figure}
            \end{column}
        \end{columns}
    \end{frame}


\end{document}
